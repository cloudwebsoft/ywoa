<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=gb2312">
<STYLE type=text/css>BODY {
	FONT: 9pt "宋体", Verdana, Arial, Helvetica, sans-serif
}
A {
	FONT: 9pt "宋体", Verdana, Arial, Helvetica, sans-serif
}
TABLE {
	FONT: 9pt "宋体", Verdana, Arial, Helvetica, sans-serif
}
DIV {
	FONT: 9pt "宋体", Verdana, Arial, Helvetica, sans-serif
}
SPAN {
	FONT: 9pt "宋体", Verdana, Arial, Helvetica, sans-serif
}
TD {
	FONT: 9pt "宋体", Verdana, Arial, Helvetica, sans-serif
}
TH {
	FONT: 9pt "宋体", Verdana, Arial, Helvetica, sans-serif
}
INPUT {
	FONT: 9pt "宋体", Verdana, Arial, Helvetica, sans-serif
}
SELECT {
	FONT: 9pt "宋体", Verdana, Arial, Helvetica, sans-serif
}
BODY {
	PADDING-RIGHT: 5px; PADDING-LEFT: 5px; PADDING-BOTTOM: 5px; PADDING-TOP: 5px
}
</STYLE>
<SCRIPT language=JavaScript src="../editorDialog/dialog.js"></SCRIPT>
<script language="javascript" event="onerror(msg, url, line)" for="window">
return true ;	 // 隐藏错误
</script>
<SCRIPT language=JavaScript>
var sAction = "INSERT";
var sTitle = "插入";

var oControl;
var oSeletion;
var sRangeType;

var sFromUrl = "http://";
var sAlt = "";
var sBorder = "0";
var sBorderColor = "#000000";
var sFilter = "";
var sAlign = "";
var sWidth = "";
var sHeight = "";
var sVSpace = "";
var sHSpace = "";

var sCheckFlag = "file";

if (sRangeType == "Control") {
	oSelection = dialogArguments.WebEditor.document.selection.createRange();
	sRangeType = dialogArguments.WebEditor.document.selection.type;
	if (oSelection.item(0).tagName == "IMG"){
		sAction = "MODI";
		sTitle = "修改";
		sCheckFlag = "url";
		oControl = oSelection.item(0);
		sFromUrl = oControl.src;
		sAlt = oControl.alt;
		sBorder = oControl.border;
		sBorderColor = oControl.style.borderColor;
		sFilter = oControl.style.filter;
		sAlign = oControl.align;
		sWidth = oControl.width;
		sHeight = oControl.height;
		sVSpace = oControl.vspace;
		sHSpace = oControl.hspace;
	}
}


document.write("<title>图片属性（" + sTitle + "）</title>");


// 初始值
function InitDocument(){
	d_fromurl.focus();d_fromurl.value='http://';
	d_alt.value = sAlt;
	d_border.value = sBorder;
	d_bordercolor.value = sBorderColor;
	s_bordercolor.style.backgroundColor = sBorderColor;
	d_width.value = sWidth;
	d_height.value = sHeight;
	d_vspace.value = sVSpace;
	d_hspace.value = sHSpace;
}


function ReturnValue(){
	sFromUrl = d_fromurl.value;
	sAlt = d_alt.value;
	sBorder = d_border.value;
	sBorderColor = d_bordercolor.value;
	sFilter = d_filter.value;
	sAlign = d_align.value;
	sWidth = d_width.value;
	sHeight = d_height.value;
	sVSpace = d_vspace.value;
	sHSpace = d_hspace.value;

	if (sAction == "MODI") {
		oControl.src = sFromUrl;
		oControl.alt = sAlt;
		oControl.border = sBorder;
		oControl.style.borderColor = sBorderColor;
		oControl.style.filter = sFilter;
		oControl.align = sAlign;
		oControl.width = sWidth;
		oControl.height = sHeight;
		oControl.vspace = sVSpace;
		oControl.hspace = sHSpace;
	}else{
		var sHTML = '<img src="'+sFromUrl+'" alt="'+sAlt+'" border="'+sBorder+'" style="filter:'+sFilter+';border-color:'+sBorderColor+'" align="'+sAlign+'"';
		if (sWidth!=""){
			sHTML=sHTML+' width="'+sWidth+'"';
		}
		if (sHeight!=""){
			sHTML=sHTML+' height="'+sHeight+'"';
		}
		sHTML = sHTML+' vspace="'+sVSpace+'" hspace="'+sHSpace+'">';
		dialogArguments.insertHTML(sHTML);
	}

	window.returnValue = null;
	window.close();
}

// 点确定时执行
function ok(){
	// 数字型输入的有效性
	d_border.value = ToInt(d_border.value);
	d_width.value = ToInt(d_width.value);
	d_height.value = ToInt(d_height.value);
	d_vspace.value = ToInt(d_vspace.value);
	d_hspace.value = ToInt(d_hspace.value);
	// 边框颜色的有效性
	if (!IsColor(d_bordercolor.value)){
		BaseAlert(d_bordercolor,'提示：\n\n无效的边框颜色值！');
		return false;
	}
	
	if (d_checkfromurl.checked){
		// 返回值
		ReturnValue();
	}
}

</SCRIPT>

<META content="MSHTML 6.00.3790.118" name=GENERATOR></HEAD>
<BODY bgColor=menu onload=InitDocument()>
<TABLE cellSpacing=0 cellPadding=0 align=center border=0>
  <TBODY>
  <TR>
    <TD>
      <FIELDSET><LEGEND>图片来源</LEGEND>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD colSpan=9 height=5></TD></TR>
        <TR>
          <TD colSpan=9 height=5></TD></TR>
        <TR>
          <TD width=7></TD>
          <TD align=right width=54><INPUT id=d_checkfromurl type=radio CHECKED 
            value=1>网络:</TD>
          <TD width=5></TD>
          <TD colSpan=5><INPUT id=d_fromurl style="WIDTH: 243px" size=30></TD>
          <TD width=7></TD></TR>
        <TR>
          <TD colSpan=9 height=5></TD></TR></TBODY></TABLE></FIELDSET> </TD></TR>
  <TR>
    <TD height=5></TD></TR>
  <TR>
    <TD>
      <FIELDSET><LEGEND>显示效果</LEGEND>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD colSpan=9 height=5></TD></TR>
        <TR>
          <TD width=7></TD>
          <TD>说明文字:</TD>
          <TD width=5></TD>
          <TD colSpan=5><INPUT id=d_alt style="WIDTH: 243px" size=38></TD>
          <TD width=7></TD></TR>
        <TR>
          <TD colSpan=9 height=5></TD></TR>
        <TR>
          <TD width=7></TD>
          <TD noWrap>边框粗细:</TD>
          <TD width=5></TD>
          <TD><INPUT onkeypress=event.returnValue=IsDigit(); id=d_border 
            size=10></TD>
          <TD width=40></TD>
          <TD noWrap>边框颜色:</TD>
          <TD width=5></TD>
          <TD>
            <TABLE cellSpacing=0 cellPadding=0 border=0>
              <TBODY>
              <TR>
                <TD><INPUT id=d_bordercolor size=7></TD>
                <TD><IMG id=s_bordercolor style="CURSOR: hand" 
                  onclick="SelectColor('bordercolor')" 
                  src="../editorDialog/blackrect.gif" width=18 
            border=0></TD></TR></TBODY></TABLE></TD>
          <TD width=7></TD></TR>
        <TR>
          <TD colSpan=9 height=5></TD></TR>
        <TR>
          <TD width=7></TD>
          <TD>特殊效果:</TD>
          <TD width=5></TD>
          <TD><SELECT id=d_filter style="WIDTH: 72px" size=1> <OPTION 
              value="" selected>无</OPTION> <OPTION 
              value=Alpha(Opacity=50)>半透明</OPTION> <OPTION 
              value="Alpha(Opacity=0, FinishOpacity=100, Style=1, StartX=0, StartY=0, FinishX=100, FinishY=140)">线型透明</OPTION> 
              <OPTION 
              value="Alpha(Opacity=10, FinishOpacity=100, Style=2, StartX=30, StartY=30, FinishX=200, FinishY=200)">放射透明</OPTION> 
              <OPTION 
              value=blur(add=1,direction=14,strength=15)>模糊效果</OPTION><OPTION 
              value=blur(add=true,direction=45,strength=30)>风动模糊</OPTION> 
              <OPTION 
              value="Wave(Add=0, Freq=60, LightStrength=1, Phase=0, Strength=3)">正弦波纹</OPTION> 
              <OPTION value=gray>黑白照片</OPTION><OPTION 
              value=Chroma(Color=#FFFFFF)>白色透明</OPTION> <OPTION 
              value="DropShadow(Color=#999999, OffX=7, OffY=4, Positive=1)">投射阴影</OPTION> 
              <OPTION value="Shadow(Color=#999999, Direction=45)">阴影</OPTION> 
              <OPTION value="Glow(Color=#ff9900, Strength=5)">发光</OPTION> 
              <OPTION value=flipv>垂直翻转</OPTION> <OPTION 
              value=fliph>左右翻转</OPTION> <OPTION value=grays>降低彩色</OPTION> 
              <OPTION value=xray>X光照片</OPTION> <OPTION 
            value=invert>底片</OPTION></SELECT> </TD>
          <TD width=40></TD>
          <TD>对齐方式:</TD>
          <TD width=5></TD>
          <TD><SELECT id=d_align style="WIDTH: 72px" size=1> <OPTION 
              value="" selected>默认</OPTION> <OPTION value=left>居左</OPTION> 
              <OPTION value=right>居右</OPTION> <OPTION value=top>顶部</OPTION> 
              <OPTION value=middle>中部</OPTION> <OPTION value=bottom>底部</OPTION> 
              <OPTION value=absmiddle>绝对居中</OPTION> <OPTION 
              value=absbottom>绝对底部</OPTION> <OPTION value=baseline>基线</OPTION> 
              <OPTION value=texttop>文本顶部</OPTION></SELECT> </TD>
          <TD width=7></TD></TR>
        <TR>
          <TD colSpan=9 height=5></TD></TR>
        <TR>
          <TD width=7></TD>
          <TD>图片宽度:</TD>
          <TD width=5></TD>
          <TD><INPUT onkeypress=event.returnValue=IsDigit(); id=d_width 
            maxLength=4 size=10></TD>
          <TD width=40></TD>
          <TD>图片高度:</TD>
          <TD width=5></TD>
          <TD><INPUT onkeypress=event.returnValue=IsDigit(); id=d_height 
            maxLength=4 size=10></TD>
          <TD width=7></TD></TR>
        <TR>
          <TD colSpan=9 height=5></TD></TR>
        <TR>
          <TD width=7></TD>
          <TD>上下间距:</TD>
          <TD width=5></TD>
          <TD><INPUT onkeypress=event.returnValue=IsDigit(); id=d_vspace 
            maxLength=2 size=10></TD>
          <TD width=40></TD>
          <TD>左右间距:</TD>
          <TD width=5></TD>
          <TD><INPUT onkeypress=event.returnValue=IsDigit(); id=d_hspace 
            maxLength=2 size=10></TD>
          <TD width=7></TD></TR>
        <TR>
          <TD colSpan=9 height=5></TD></TR></TBODY></TABLE></FIELDSET> </TD></TR>
  <TR>
    <TD height=5></TD></TR>
  <TR>
    <TD 
      align=right><INPUT id=Ok onclick=ok() type=submit value="  确定  ">&nbsp;&nbsp;<INPUT onclick=window.close(); type=button value="  取消  "></TD></TR></TBODY></TABLE></BODY></HTML>
